sudo: required

branches:
  only:
    - master

language: C


jobs:
  include:
   - stage: test
     env: ROUTER_NAME=hsl
     script: ./prebuild.sh
   - stage: test
     env: ROUTER_NAME=waltti
     script: ./prebuild.sh
   - stage: test
     env: ROUTER_NAME=finland
     script: ./prebuild.sh

   - stage: build
     env: ROUTER_NAME=hsl
     script: ./build-docker-image.sh
   - stage: build
     env: ROUTER_NAME=waltti
     script: ./build-docker-image.sh
   - stage: build
     env: ROUTER_NAME=finland
     script: ./build-docker-image.sh

   - stage: deploy
     env: ROUTER_NAME=hsl
     script: ./deploy.sh
   - stage: deploy
     env: ROUTER_NAME=waltti
     script: ./deploy.sh
   - stage: deploy
     env: ROUTER_NAME=finland
     script: ./deploy.sh

services:
 - docker

install:
 - true
